import{u as D,a as F}from"./CwT8f8SF.js";import{g as k,L as s,v as $,z as G,l as T,c as w,j as V,p as b,M as N,t as P,o as m,Y as H}from"./W4pIgQPm.js";const M={key:0},O=["src","alt"],q={key:3},C="https://cdn.jsdelivr.net/gh/jdecked/twemoji@latest/assets",Y=k({__name:"Twemoji",props:{emoji:{type:[String,Object],required:!0},size:{type:String,default:"1em"},png:{type:Boolean,default:!1}},async setup(c){let f,h;const e=c,z=o=>{const i=[];let a=0,n=0,v=0;for(;v<o.length;)a=o.charCodeAt(v++),n?(i.push((65536+(n-55296<<10)+(a-56320)).toString(16)),n=0):a>55296&&a<=56319?n=a:i.push(a.toString(16));return i.join("-")},p=typeof e.emoji=="string",g=typeof e.emoji=="object"&&e.emoji.code!==void 0&&e.emoji.emoji!==void 0&&e.emoji.name!==void 0,d=s(()=>p||g);d.value||console.warn("Invalid emoji property:",e.emoji);const u=s(()=>g?e.emoji.code.toLowerCase():p?e.emoji.replace(/u\+/gi,"").toLowerCase():""),I=s(()=>g?e.emoji.name:p?e.emoji:JSON.stringify(e.emoji)),B=s(()=>/^[0-9A-F]{1,6}(?:-[0-9A-F]{1,6})*$/i.test(u.value)),l=$({}),j=$(!1),t=s(()=>B.value?u.value:z(u.value));l.value[t.value]=t.value;const L=s(()=>`${C}/72x72/${l.value[t.value]}.png`),A=s(()=>`${C}/svg/${l.value[t.value]}.svg`),y=()=>$fetch(A.value,{responseType:"text"}).then(o=>o).catch(()=>null),r=D("twemojis",()=>({})),S=s(()=>{if(r.value[t.value])return k({render(){return H("svg",{class:"twemoji",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36",width:e.size,height:e.size,innerHTML:r.value[t.value]})}})}),x=async()=>{if(r.value[t.value]||!d.value)return;{const{expiresIn:n}=F().twemoji,v=localStorage.getItem("twemoji-expiry");(!n||Date.now()>Number(v))&&(localStorage.removeItem(`twemoji-${t.value}`),localStorage.setItem("twemoji-expiry",String(Date.now()+n*1e3)));const _=localStorage.getItem(`twemoji-${t.value}`);if(_){r.value[t.value]=_;return}}j.value=!0;let o=await y();j.value=!1;const i=t.value.split("-");for(;!o&&i.length>1;)i.pop(),l.value[t.value]=i.join("-"),o=await y();if(!o)return;const a=o.replace(/<\/*svg[^>]*>/g,"");r.value[t.value]=a,localStorage.setItem(`twemoji-${t.value}`,a)};return G(()=>e,async()=>{l.value[t.value]=t.value,e.png||await x()},{deep:!0}),e.png||([f,h]=T(()=>x()),await f,h()),(o,i)=>j.value?(m(),w("span",M)):c.png?(m(),w("img",{key:1,class:"twemoji",src:L.value,alt:I.value,style:b({width:c.size,height:c.size})},null,12,O)):S.value?(m(),V(N(S.value),{key:2})):(m(),w("span",q,P(u.value),1))}});export{Y as _};
