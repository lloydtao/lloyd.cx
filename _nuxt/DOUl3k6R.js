import{u as G,d as L,a as k}from"./C_rUSLnT.js";import{J as o,n as _,y as A,G as F,c as g,j as T,o as c,Q as V,K as b,t as q,g as N,R as P}from"./BbsFhn3w.js";const E={key:0},H=["src","alt"],J={key:3},$="https://cdn.jsdelivr.net/gh/jdecked/twemoji@latest/assets",M={__name:"Twemoji",props:{emoji:{type:[String,Object],required:!0},size:{type:String,required:!1,default:"1em"},png:{type:Boolean,required:!1}},async setup(n){let j,d;const e=n,v=typeof e.emoji=="string",m=typeof e.emoji=="object"&&e.emoji.code!==void 0&&e.emoji.emoji!==void 0&&e.emoji.name!==void 0,f=o(()=>v||m);f.value||console.warn("Invalid emoji property:",e.emoji);const l=o(()=>m?e.emoji.code.toLowerCase():v?e.emoji.replace(/u\+/gi,"").toLowerCase():""),I=o(()=>m?e.emoji.name:v?e.emoji:JSON.stringify(e.emoji)),C=o(()=>/^[0-9A-F]{1,6}(?:-[0-9A-F]{1,6})*$/i.test(l.value)),i=_({}),p=_(!1),t=o(()=>C.value?l.value:L.toCodePoints(l.value).join("-"));i.value[t.value]=t.value;const z=o(()=>`${$}/72x72/${i.value[t.value]}.png`),B=o(()=>`${$}/svg/${i.value[t.value]}.svg`),w=()=>$fetch(B.value,{responseType:"text"}).then(a=>a).catch(()=>null),s=G("twemojis",()=>({})),h=o(()=>{if(s.value[t.value])return N({render(){return P("svg",{class:"twemoji",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36",width:e.size,height:e.size,innerHTML:s.value[t.value]})}})}),y=async()=>{if(s.value[t.value]||!f.value)return;{const{expiresIn:u}=k().twemoji;if(u>0){const D=localStorage.getItem("twemoji-expiry");Date.now()>Number(D)&&(localStorage.removeItem(`twemoji-${t.value}`),localStorage.setItem("twemoji-expiry",String(Date.now()+u*1e3)));const x=localStorage.getItem(`twemoji-${t.value}`);if(x){s.value[t.value]=x;return}}}p.value=!0;let a=await w();p.value=!1;const r=t.value.split("-");for(;!a&&r.length>1;)r.pop(),i.value[t.value]=r.join("-"),a=await w();if(!a)return;const S=a.replace(/<\/*svg[^>]*>/g,"");s.value[t.value]=S;{const{expiresIn:u}=k().twemoji;u>0&&localStorage.setItem(`twemoji-${t.value}`,S)}};return A(()=>e,async()=>{i.value[t.value]=t.value,e.png||await y()},{deep:!0}),e.png||([j,d]=F(()=>y()),await j,d()),(a,r)=>p.value?(c(),g("span",E)):n.png?(c(),g("img",{key:1,class:"twemoji",src:z.value,alt:I.value,style:V({width:n.size,height:n.size})},null,12,H)):h.value?(c(),T(b(h.value),{key:2})):(c(),g("span",J,q(l.value),1))}};export{M as default};
