import{u as L,a as F}from"./B8gMwDOi.js";import{e as _,M as s,k as $,p as G,g as N,c as f,f as T,n as V,N as b,t as P,o as m,Z as H}from"./EFVLOpR4.js";const M={key:0},O=["src","alt"],q={key:3},C="https://cdn.jsdelivr.net/gh/jdecked/twemoji@latest/assets",Z=_({__name:"Twemoji",props:{emoji:{type:[String,Object],required:!0},size:{type:String,default:"1em"},png:{type:Boolean,default:!1}},async setup(c){let w,h;const e=c,I=o=>{const i=[];let a=0,n=0,v=0;for(;v<o.length;)a=o.charCodeAt(v++),n?(i.push((65536+(n-55296<<10)+(a-56320)).toString(16)),n=0):a>55296&&a<=56319?n=a:i.push(a.toString(16));return i.join("-")},p=typeof e.emoji=="string",g=typeof e.emoji=="object"&&e.emoji.code!==void 0&&e.emoji.emoji!==void 0&&e.emoji.name!==void 0,d=s(()=>p||g);d.value||console.warn("Invalid emoji property:",e.emoji);const u=s(()=>g?e.emoji.code.toLowerCase():p?e.emoji.replace(/u\+/gi,"").toLowerCase():""),z=s(()=>g?e.emoji.name:p?e.emoji:JSON.stringify(e.emoji)),B=s(()=>/^[0-9A-F]{1,6}(?:-[0-9A-F]{1,6})*$/i.test(u.value)),l=$({}),j=$(!1),t=s(()=>B.value?u.value:I(u.value));l.value[t.value]=t.value;const A=s(()=>`${C}/72x72/${l.value[t.value]}.png`),D=s(()=>`${C}/svg/${l.value[t.value]}.svg`),y=()=>$fetch(D.value,{responseType:"text"}).then(o=>o).catch(()=>null),r=L("twemojis",()=>({})),S=s(()=>{if(r.value[t.value])return _({render(){return H("svg",{class:"twemoji",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36",width:e.size,height:e.size,innerHTML:r.value[t.value]})}})}),x=async()=>{if(r.value[t.value]||!d.value)return;{const{expiresIn:n}=F().twemoji,v=localStorage.getItem("twemoji-expiry");(!n||Date.now()>Number(v))&&(localStorage.removeItem(`twemoji-${t.value}`),localStorage.setItem("twemoji-expiry",String(Date.now()+n*1e3)));const k=localStorage.getItem(`twemoji-${t.value}`);if(k){r.value[t.value]=k;return}}j.value=!0;let o=await y();j.value=!1;const i=t.value.split("-");for(;!o&&i.length>1;)i.pop(),l.value[t.value]=i.join("-"),o=await y();if(!o)return;const a=o.replace(/<\/*svg[^>]*>/g,"");r.value[t.value]=a,localStorage.setItem(`twemoji-${t.value}`,a)};return G(()=>e,async()=>{l.value[t.value]=t.value,e.png||await x()},{deep:!0}),e.png||([w,h]=N(()=>x()),await w,h()),(o,i)=>j.value?(m(),f("span",M)):c.png?(m(),f("img",{key:1,class:"twemoji",src:A.value,alt:z.value,style:V({width:c.size,height:c.size})},null,12,O)):S.value?(m(),T(b(S.value),{key:2})):(m(),f("span",q,P(u.value),1))}});export{Z as _};
