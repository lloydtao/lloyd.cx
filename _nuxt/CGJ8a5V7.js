import{d as L,u as A,a as k}from"./WFt-cdg2.js";import{k as o,l as _,g as F,n as G,p as T,q as V,c as g,j as b,o as u,s as N,v as P,t as q}from"./BHdVu6OH.js";const E={key:0},H=["src","alt"],O={key:3},$="https://cdn.jsdelivr.net/gh/jdecked/twemoji@latest/assets",K={__name:"Twemoji",props:{emoji:{type:[String,Object],required:!0},size:{type:String,default:"1em"},png:{type:Boolean,default:!1}},async setup(n){let j,d;const e=n,v=typeof e.emoji=="string",m=typeof e.emoji=="object"&&e.emoji.code!==void 0&&e.emoji.emoji!==void 0&&e.emoji.name!==void 0,f=o(()=>v||m);f.value||console.warn("Invalid emoji property:",e.emoji);const l=o(()=>m?e.emoji.code.toLowerCase():v?e.emoji.replace(/u\+/gi,"").toLowerCase():""),I=o(()=>m?e.emoji.name:v?e.emoji:JSON.stringify(e.emoji)),C=o(()=>/^[0-9A-F]{1,6}(?:-[0-9A-F]{1,6})*$/i.test(l.value)),s=_({}),p=_(!1),t=o(()=>C.value?l.value:L.toCodePoints(l.value).join("-"));s.value[t.value]=t.value;const z=o(()=>`${$}/72x72/${s.value[t.value]}.png`),B=o(()=>`${$}/svg/${s.value[t.value]}.svg`),w=()=>$fetch(B.value,{responseType:"text"}).then(a=>a).catch(()=>null),i=A("twemojis",()=>({})),h=o(()=>{if(i.value[t.value])return F({render(){return G("svg",{class:"twemoji",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36",width:e.size,height:e.size,innerHTML:i.value[t.value]})}})}),y=async()=>{if(i.value[t.value]||!f.value)return;{const{expiresIn:c}=k().twemoji;if(c>0){const D=localStorage.getItem("twemoji-expiry");Date.now()>Number(D)&&(localStorage.removeItem(`twemoji-${t.value}`),localStorage.setItem("twemoji-expiry",String(Date.now()+c*1e3)));const x=localStorage.getItem(`twemoji-${t.value}`);if(x){i.value[t.value]=x;return}}}p.value=!0;let a=await w();p.value=!1;const r=t.value.split("-");for(;!a&&r.length>1;)r.pop(),s.value[t.value]=r.join("-"),a=await w();if(!a)return;const S=a.replace(/<\/*svg[^>]*>/g,"");i.value[t.value]=S;{const{expiresIn:c}=k().twemoji;c>0&&localStorage.setItem(`twemoji-${t.value}`,S)}};return T(()=>e,async()=>{s.value[t.value]=t.value,e.png||await y()},{deep:!0}),e.png||([j,d]=V(()=>y()),await j,d()),(a,r)=>p.value?(u(),g("span",E)):n.png?(u(),g("img",{key:1,class:"twemoji",src:z.value,alt:I.value,style:N({width:n.size,height:n.size})},null,12,H)):h.value?(u(),b(P(h.value),{key:2})):(u(),g("span",O,q(l.value),1))}};export{K as default};
